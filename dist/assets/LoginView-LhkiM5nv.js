import{r as p,u as c,E as n,a as C,_ as I,b as U,o as K,w as r,e as t,f as D,g,h as f,i as o}from"./index-lKMbzYlX.js";const w=C(),F={computed:{loggedInUser(){return this.$store.state.user}},setup(){return{form:p({username:"",password:""}),formDataRef:w,rules:p({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{max:30,message:"用户名长度最多为30位",trigger:"blur"},{pattern:/^[a-zA-Z0-9]+$/,message:"用户名仅能包含字母和数字",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{max:20,message:"密码长度最多为20位",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}]})}},mounted(){this.loggedInUser&&this.$router.push("/")},methods:{login(){try{w.value.validate(a=>{a?c.login(this.form.username,this.form.password).then(e=>{e.success?c.getLoggedInUser().then(m=>{localStorage.setItem("loggedIn","ok"),this.$store.commit("setUser",m),this.$router.push("/"),n.success("登录成功")}):(n.error(e.message),e.message=="已登录"&&this.$router.push("/"))}).catch(()=>{n.error("未知错误")}):n.error("请检查输入")})}catch{n.error("请检查输入")}}}},j="/login.jpg";function q(a,e,m,s,E,l){const h=o("el-aside"),y=o("el-text"),b=o("el-divider"),i=o("el-input"),d=o("el-form-item"),x=o("el-form"),V=o("el-button"),_=o("el-container"),v=o("el-main"),B=o("el-col"),k=o("el-row");return K(),U(k,{justify:"center",style:{"margin-top":"60px"}},{default:r(()=>[t(B,{span:24,class:"center-items"},{default:r(()=>[t(_,{id:"main-container"},{default:r(()=>[t(h,{id:"image"},{default:r(()=>e[2]||(e[2]=[D("img",{alt:"",src:j},null,-1)])),_:1}),t(v,{style:{"max-width":"300px","margin-left":"10px"}},{default:r(()=>[t(y,{tag:"b"},{default:r(()=>e[3]||(e[3]=[g("系统登录")])),_:1}),t(b),t(x,{ref:"formDataRef",model:s.form,rules:s.rules,"label-width":"auto","hide-required-asterisk":""},{default:r(()=>[t(d,{label:"用户名",prop:"username"},{default:r(()=>[t(i,{modelValue:s.form.username,"onUpdate:modelValue":e[0]||(e[0]=u=>s.form.username=u),onKeyup:f(l.login,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(d,{label:"密码",prop:"password"},{default:r(()=>[t(i,{modelValue:s.form.password,"onUpdate:modelValue":e[1]||(e[1]=u=>s.form.password=u),type:"password",onKeyup:f(l.login,["enter"]),"show-password":""},null,8,["modelValue","onKeyup"])]),_:1})]),_:1},8,["model","rules"]),t(_,{style:{"justify-content":"end"}},{default:r(()=>[t(V,{type:"primary",onClick:l.login},{default:r(()=>e[4]||(e[4]=[g("登录")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const L=I(F,[["render",q],["__scopeId","data-v-64d5828a"]]);export{L as default};
