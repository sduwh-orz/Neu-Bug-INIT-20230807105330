import{q,r as b,u as v,P as z,E as f,a as E,_ as Z,c as w,e as a,C as P,b as V,w as l,F as B,i as t,D as j,o as m,f as x,g,G as K,h as O}from"./index-lKMbzYlX.js";import{B as S}from"./BreadCrumbNav-BtYp_qB0.js";const G="user_manage",d=b({username:"",password:"",realName:"",role:"",email:""}),c=b([]),p=E(!0),_=E(),L={components:{EditPen:q,BreadCrumbNav:S},setup(){return{loading:p,roles:c,formData:d,formDataRef:_,formRules:b({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{max:30,message:"用户名长度最多为30位",trigger:"blur"},{min:6,message:"用户名长度至少为6位",trigger:"blur"},{pattern:/^[a-zA-Z0-9]+$/,message:"用户名仅能包含字母和数字",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{max:20,message:"密码长度最多为20位",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}],realName:[{required:!0,message:"请选择真实姓名",trigger:"blur"},{max:30,message:"真实姓名长度不能超过30个字",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}],email:[{max:50,message:"邮箱长度不能超过50个字符",trigger:"blur"},{pattern:/^[A-Za-zd]+([-_.][A-Za-zd]+)*@([A-Za-zd]+[-.])+[A-Za-zd]{2,5}$/,message:"邮箱格式错误",trigger:"blur"}]})}},mounted(){Object.keys(d).forEach(function(u){d[u]=""}),p.value=!0,v.getRoles().then(u=>{c.length=0,Object.assign(c,z.toOptions(u,!0)),p.value=!1})},methods:{handleSubmit(){try{_.value.validate().then(()=>{v.create(d).then(u=>{u.success?(f.success("添加成功"),_.value.resetFields(),this.$router.push("/"+G+"/list")):f.error(u.message?u.message:"添加失败")})})}catch{f.error("请检查输入内容")}},handleReturn(){this.$router.go(-1)}}},M={class:"card-header"};function T(u,e,H,r,I,i){const y=t("BreadCrumbNav"),A=t("EditPen"),C=t("el-icon"),n=t("el-input"),s=t("el-form-item"),N=t("el-option"),h=t("el-select"),k=t("el-form"),D=t("el-button"),F=t("el-row"),R=t("el-card"),U=j("loading");return m(),w(B,null,[a(y,{"page-paths":["用户管理","用户列表","用户添加"]}),P((m(),V(R,{class:"info-card",shadow:"never"},{header:l(()=>[x("div",M,[a(C,null,{default:l(()=>[a(A)]),_:1}),e[5]||(e[5]=g("  用户添加 "))])]),footer:l(()=>[a(F,{class:"row-bg",justify:"end"},{default:l(()=>[e[8]||(e[8]=x("div",{class:"flex-grow"},null,-1)),a(D,{type:"info",onClick:i.handleReturn,round:""},{default:l(()=>e[6]||(e[6]=[g("返回用户列表")])),_:1},8,["onClick"]),a(D,{type:"primary",onClick:i.handleSubmit,round:""},{default:l(()=>e[7]||(e[7]=[g("提交")])),_:1},8,["onClick"])]),_:1})]),default:l(()=>[a(k,{ref:"formDataRef",model:r.formData,rules:r.formRules,"label-width":"30%",style:{width:"60%"},onKeyup:O(i.handleSubmit,["enter"])},{default:l(()=>[a(s,{label:"用户名",prop:"username"},{default:l(()=>[a(n,{modelValue:r.formData.username,"onUpdate:modelValue":e[0]||(e[0]=o=>r.formData.username=o)},null,8,["modelValue"])]),_:1}),a(s,{label:"密码",prop:"password"},{default:l(()=>[a(n,{modelValue:r.formData.password,"onUpdate:modelValue":e[1]||(e[1]=o=>r.formData.password=o),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(s,{label:"真实姓名",prop:"realName"},{default:l(()=>[a(n,{modelValue:r.formData.realName,"onUpdate:modelValue":e[2]||(e[2]=o=>r.formData.realName=o)},null,8,["modelValue"])]),_:1}),a(s,{label:"角色",prop:"role"},{default:l(()=>[a(h,{modelValue:r.formData.role,"onUpdate:modelValue":e[3]||(e[3]=o=>r.formData.role=o),placeholder:"请选择...","no-data-text":"暂无角色"},{default:l(()=>[(m(!0),w(B,null,K(r.roles,o=>(m(),V(N,{key:o.value,label:o.name,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"邮箱",prop:"email"},{default:l(()=>[a(n,{modelValue:r.formData.email,"onUpdate:modelValue":e[4]||(e[4]=o=>r.formData.email=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules","onKeyup"])]),_:1})),[[U,r.loading]])],64)}const W=Z(L,[["render",T]]);export{W as default};
