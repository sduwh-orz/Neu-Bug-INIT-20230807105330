import{q as C,r as g,s as E,u as x,E as l,a as v,_ as D,c as V,e as r,w as o,F as h,i as a,o as y,f as N,g as w,h as k}from"./index-lKMbzYlX.js";import{B as q}from"./BreadCrumbNav-BtYp_qB0.js";const d=g({oldPassword:"",newPassword:"",confirmPassword:""}),m=v(),A={components:{EditPen:C,BreadCrumbNav:q},setup(){return{formData:d,formDataRef:m,formRules:g({oldPassword:[{required:!0,message:"请输入原密码",trigger:"blur"},{max:20,message:"密码长度最多为20位",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{max:20,message:"密码长度最多为20位",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{max:20,message:"密码长度最多为20位",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"},{validator:(u,e,i)=>{e!==d.newPassword?i(new Error("两次输入的密码不一致")):i()},trigger:"blur"}]})}},methods:{submitForm(){try{m.value.validate(u=>{if(u)E.confirm("确定要修改密码吗？提交后需要重新登录。","修改确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{x.password(d.oldPassword,d.newPassword).then(e=>{if(e.success)localStorage.removeItem("loggedIn"),l.success("密码修改成功"),m.value.resetFields(),this.$router.push("/login");else return l.error(e.message?e.message:"修改失败"),!1})}).catch(()=>{l.info("已取消密码修改")});else return l.warning("请检查表单所填写内容"),!1})}catch{l.error("请检查输入内容")}},resetForm(){m.value.resetFields()}}},R={class:"card-header"};function U(u,e,i,s,K,f){const _=a("BreadCrumbNav"),B=a("EditPen"),P=a("el-icon"),c=a("el-input"),n=a("el-form-item"),p=a("el-button"),b=a("el-form"),F=a("el-card");return y(),V(h,null,[r(_,{"page-paths":["我的面板","修改密码"]}),r(F,{class:"info-card",shadow:"never"},{header:o(()=>[N("div",R,[r(P,null,{default:o(()=>[r(B)]),_:1}),e[3]||(e[3]=w("  修改密码 "))])]),default:o(()=>[r(b,{ref:"formDataRef",model:s.formData,rules:s.formRules,"label-width":"100px",class:"password-form",onKeyup:k(f.submitForm,["enter"])},{default:o(()=>[r(n,{label:"原密码",prop:"oldPassword"},{default:o(()=>[r(c,{modelValue:s.formData.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=t=>s.formData.oldPassword=t),type:"password",autocomplete:"off",placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),r(n,{label:"新密码",prop:"newPassword"},{default:o(()=>[r(c,{modelValue:s.formData.newPassword,"onUpdate:modelValue":e[1]||(e[1]=t=>s.formData.newPassword=t),type:"password",autocomplete:"off",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(n,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[r(c,{modelValue:s.formData.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>s.formData.confirmPassword=t),type:"password",autocomplete:"off",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(n,null,{default:o(()=>[r(p,{type:"primary",onClick:f.submitForm},{default:o(()=>e[4]||(e[4]=[w("提交")])),_:1},8,["onClick"]),r(p,{onClick:f.resetForm},{default:o(()=>e[5]||(e[5]=[w("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules","onKeyup"])]),_:1})],64)}const M=D(A,[["render",U]]);export{M as default};
